# peripheral.yaml

peripheral:
  localName: Bloxy
  appearance: 960  # Mouse/Keyboard combo
  services:
    - name: HID service
      uuid: 00001812-0000-1000-8000-00805f9b34fb
      description: Human Interface Device Service
      type: primary
      characteristics:
        - name: HID Information
          uuid: 00002a4a-0000-1000-8000-00805f9b34fb
          description: HID Information (Version, Country Code, Flags)
          value:
            - 0x11 # HID Minor Version 11
            - 0x01 # HID Major Version 1
            - 0x00 # Country Code 0
            - 0x07 # Flags: RemoteWake + NormallyConnectable + BootProtocol
          notifying: false
          flags: [read]
          descriptors: []

        - name: HID Report Map
          uuid: 00002a4b-0000-1000-8000-00805f9b34fb
          description: HID Report Map characteristic
          value:
            # ---------------- Keyboard (Report ID 1) ----------------
            - 05 
            - 01        # Usage Page (Generic Desktop)
            - 09 
            - 06        # Usage (Keyboard)
            - A1 
            - 01        # Collection (Application)
            - 85 
            - 01        # Report ID (1)


            - 05 
            - 07        # Usage Page (Keyboard/Keypad)
            - 19 
            - E0        # Usage Minimum (LeftControl)
            - 29 
            - E7        # Usage Maximum (Right GUI)
            - 15 
            - 00        # Logical Min (0)
            - 25 
            - 01        # Logical Max (1)
            - 95 
            - 08        # Report Count (8)
            - 75 
            - 01        # Report Size (1)
            - 81 
            - 02        # Input (Data, Var, Abs)


            - 95 
            - 01        # Reserved byte
            - 75 
            - 08
            - 81 
            - 01        # Input (Const)


            - 19 
            - 01        # Usage Min (ErrorRollOver)
            - 29 
            - 65        # Usage Max (Keyboard Application)
            - 15 
            - 01        # Logical Min (1)
            - 25 
            - 65        # Logical Max (101)
            - 95 
            - 06        # Report Count (6)
            - 75 
            - 08        # Report Size (8)
            - 81 
            - 00        # Input (Data, Array, Abs)


            # LEDs output (Num/Caps/Scroll/Kana/Compose)
            - 05 
            - 08        # Usage Page (LEDs)
            - 19 
            - 01        # Usage Min (Num Lock)
            - 29 
            - 05        # Usage Max (Kana)
            - 15 
            - 00
            - 25 
            - 01
            - 95 
            - 05
            - 75 
            - 01
            - 91 
            - 02        # Output (Data, Var, Abs)
            - 95 
            - 01        # Padding
            - 75 
            - 03
            - 91 
            - 03        # Output (Const)
            - C0 
                        # End Collection (Keyboard)


            # ---------------- Mouse (Report ID 2) ----------------
            - 05 
            - 01        # Usage Page (Generic Desktop)
            - 09 
            - 02        # Usage (Mouse)
            - A1 
            - 01        # Collection (Application)
            - 85 
            - 02        # Report ID (2)
            - A1 
            - 00        # Collection (Physical)


            - 05 
            - 09        # Usage Page (Button)
            - 19 
            - 01        # Usage Min (Button 1)
            - 29 
            - 03        # Usage Max (Button 3)
            - 15 
            - 00
            - 25 
            - 01
            - 95 
            - 03
            - 75 
            - 01
            - 81 
            - 02        # Input (Data, Var, Abs)


            - 95 
            - 01        # Padding
            - 75 
            - 05
            - 81 
            - 03        # Input (Const)


            - 05 
            - 01        # Usage Page (Generic Desktop)
            - 09 
            - 30        # Usage (X)
            - 09 
            - 31        # Usage (Y)
            - 09 
            - 38        # Usage (Wheel)
            - 15 
            - 81        # Logical Min (-127)
            - 25 
            - 7F        # Logical Max (127)
            - 95 
            - 03        # Report Count (3)
            - 75 
            - 08        # Report Size (8)
            - 81 
            - 06        # Input (Data, Var, Rel)
            - C0             # End Collection (Physical)
            - C0             # End Collection (Mouse)


          notifying: false
          flags: [read]
          descriptors:
            - name: Battery Service External Report Reference Descriptor
              uuid: 00002907-0000-1000-8000-00805f9b34fb
              description: External Report Reference Descriptor linking to Battery Service
              value:
                - 0x0F # UUID 0x180F (Battery Service)
                - 0x18
              flags: [read]

        - name: HID Protocol Mode
          uuid: 00002a4e-0000-1000-8000-00805f9b34fb
          description: Protocol Mode characteristic (Report Mode = 1)
          value: [0x01]
          notifying: false
          flags: [read, write-without-response]
          descriptors: []

        - name: HID Control Point
          uuid: 00002a4c-0000-1000-8000-00805f9b34fb
          description: HID Control Point characteristic (used to suspend/resume)
          value: [0x00]
          notifying: false
          flags: [write-without-response]
          descriptors: []

        - name: HID Report - Input (Keyboard)
          uuid: 00002a4d-0000-1000-8000-00805f9b34fb
          description: HID Report - Input (Keyboard)
          value:
            - 0x01  # Report ID 1
            - 0x00  # Modifiers
            - 0x00  # Reserved
            - 0x00  # Keycode 1
            - 0x00  # Keycode 2
            - 0x00  # Keycode 3
            - 0x00  # Keycode 4
            - 0x00  # Keycode 5
            - 0x00  # Keycode 6
          notifying: false
          flags: [read, notify]
          descriptors:
            - name: Report Reference Descriptor
              uuid: 00002908-0000-1000-8000-00805f9b34fb
              value: [0x01, 0x01]  # Report ID 1, Input
              flags: [read]
            - name: Client Characteristic Configuration Descriptor
              uuid: 00002902-0000-1000-8000-00805f9b34fb
              value: [0x00, 0x00]
              flags: [read, write]

        - name: HID Report - Input (Mouse)
          uuid: 00002a4d-0000-1000-8000-00805f9b34fb
          description: HID Report - Input (Mouse)
          value:
            - 0x02  # Report ID 2
            - 0x00  # Buttons (3 bits used)
            - 0x00  # X delta
            - 0x00  # Y delta
            - 0x00  # Wheel
          notifying: false
          flags: [read, notify]
          descriptors:
            - name: Report Reference Descriptor
              uuid: 00002908-0000-1000-8000-00805f9b34fb
              value: [0x02, 0x01]  # Report ID 2, Input
              flags: [read]
            - name: Client Characteristic Configuration Descriptor
              uuid: 00002902-0000-1000-8000-00805f9b34fb
              value: [0x00, 0x00]
              flags: [read, write]

        - name: HID Report - Output (Keyboard LEDs)
          uuid: 00002a4d-0000-1000-8000-00805f9b34fb
          description: HID Report - Output (Keyboard LEDs)
          value: [0x01, 0x00]  # Report ID 1, LEDs bitfield (1 byte)
          notifying: false
          flags: [read, write, write-without-response]
          descriptors:
            - name: Report Reference Descriptor
              uuid: 00002908-0000-1000-8000-00805f9b34fb
              value: [0x01, 0x02]   # Report ID 1, Output
              flags: [read]

        - name: Boot Keyboard Input Report
          uuid: 00002a22-0000-1000-8000-00805f9b34fb
          description: Boot Keyboard Input Report (8 bytes)
          value: [0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00]
          notifying: false
          flags: [read, notify]
          descriptors:
            - name: Client Characteristic Configuration Descriptor
              uuid: 00002902-0000-1000-8000-00805f9b34fb
              value: [0x00, 0x00]
              flags: [read, write]

        - name: Boot Keyboard Output Report
          uuid: 00002a32-0000-1000-8000-00805f9b34fb
          description: Boot Keyboard Output Report (1 byte LEDs)
          value: [0x00]
          notifying: false
          flags: [read, write, write-without-response]
          descriptors: []

        - name: Boot Mouse Input Report
          uuid: 00002a33-0000-1000-8000-00805f9b34fb
          description: Boot Mouse Input Report (3 bytes: buttons, X, Y)
          value: [0x00,0x00,0x00]
          notifying: false
          flags: [read, notify]
          descriptors:
            - name: Client Characteristic Configuration Descriptor
              uuid: 00002902-0000-1000-8000-00805f9b34fb
              value: [0x00, 0x00]
              flags: [read, write]

        # Optional: Battery as HID Input (Report ID 3 via External Report Ref)
        - name: HID Battery Strength (via Report ID 3)
          uuid: 00002a4d-0000-1000-8000-00805f9b34fb
          description: HID Battery Strength Input (matches Report ID 3 in map)
          value: [0x03, 0x64]  # Report ID 3, 100%
          notifying: false
          flags: [read, notify]
          descriptors:
            - name: Report Reference Descriptor
              uuid: 00002908-0000-1000-8000-00805f9b34fb
              value: [0x03, 0x01]  # Report ID 3, Input
              flags: [read]
            - name: Client Characteristic Configuration Descriptor
              uuid: 00002902-0000-1000-8000-00805f9b34fb
              value: [0x00, 0x00]
              flags: [read, write]

    - name: Battery Service
      uuid: 0000180f-0000-1000-8000-00805f9b34fb
      description: Battery Service
      type: primary
      characteristics:
        - name: Battery Level
          uuid: 00002a19-0000-1000-8000-00805f9b34fb
          description: Battery Level characteristic
          value: [0x64] # 100%
          notifying: false
          flags: [read, notify]
          descriptors:
            - name: Client Characteristic Configuration Descriptor
              uuid: 00002902-0000-1000-8000-00805f9b34fb
              description: Enables notifications or indications
              value: [0x00, 0x00]
              flags: [read, write]
            - name: Report Reference Descriptor
              uuid: 00002908-0000-1000-8000-00805f9b34fb
              description: Link Battery Level into HID via External Report Ref
              value: [0x03, 0x01]  # Report ID 3, Input
              flags: [read]

    - name: Device Information Service
      uuid: 0000180a-0000-1000-8000-00805f9b34fb
      description: Device Information Service
      type: primary
      characteristics:
        - name: Manufacturer Name String
          uuid: 00002a29-0000-1000-8000-00805f9b34fb
          description: Manufacturer Name String characteristic
          value: [0x4D,0x65,0x65,0x68,0x6F,0x67,0x20,0x43,0x6F,0x2E]
          notifying: false
          flags: [read]
          descriptors: []
        - name: Model Number String
          uuid: 00002a24-0000-1000-8000-00805f9b34fb
          description: Model Number String characteristic
          value: [0x42,0x6C,0x6F,0x78,0x79]
          notifying: false
          flags: [read]
          descriptors: []
        - name: Serial Number String
          uuid: 00002a25-0000-1000-8000-00805f9b34fb
          description: Serial Number String characteristic
          value: [0x30,0x30,0x31]
          notifying: false
          flags: [read]
          descriptors: []
        - name: Firmware Revision String
          uuid: 00002a26-0000-1000-8000-00805f9b34fb
          description: Firmware Revision String characteristic
          value: [0x31,0x2E,0x30,0x2E,0x30]
          notifying: false
          flags: [read]
          descriptors: []
        - name: Hardware Revision String
          uuid: 00002a27-0000-1000-8000-00805f9b34fb
          description: Hardware Revision String characteristic
          value: [0x31,0x2E,0x30]
          notifying: false
          flags: [read]
          descriptors: []
        - name: Software Revision String
          uuid: 00002a28-0000-1000-8000-00805f9b34fb
          description: Software Revision String characteristic
          value: [0x31,0x2E,0x30]
          notifying: false
          flags: [read]
          descriptors: []
        - name: System ID
          uuid: 00002a23-0000-1000-8000-00805f9b34fb
          description: System ID characteristic
          value: [0x12,0x34,0x56,0xFF,0xFE,0x9A,0xBC,0xDE]
          notifying: false
          flags: [read]
          descriptors: []
        - name: PnP ID
          uuid: 00002a50-0000-1000-8000-00805f9b34fb
          description: Plug and Play ID characteristic
          value: [0x01, 0xFF, 0xFF, 0x34, 0x12, 0x00, 0x01]
          notifying: false
          flags: [read]
          descriptors: []